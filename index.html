<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>teste</title>
</head>
<body>
<button type="button" onclick="createIframe();">CriarFrame</button>
<button type="button" onclick="mario();">Enviar Mensagem pra iframe </button>
<div style="width: 100%; height: 100%; top:30px; left: 0; position: absolute;" class="active" id="dic2">
	<div class="topo" style="width: 100%; position: absolute; background-color: red;">
		<div style="position: absolute; right: 0px; padding: 10px; "><button onclick="mario();">-</button></div>
	</div>
</div>
<script type="text/javascript">
	window.onload = function(e) {
	  window.addEventListener('message', event => {
	  	console.log(event);
	  }, false);
	  
	};
	function createIframe () {
		var params = {
            token: '2',
            publicKey: '2'
        };
        const divId = document.getElementById('dic2');
        var form = document.createElement("form");
       	form.setAttribute("frame-border", "0");
        form.setAttribute("method", "post");
        form.setAttribute("action", '2.php');
        form.setAttribute("target", "teste2");
        for (var i in params) {
            if (params.hasOwnProperty(i)) {
                var input = document.createElement('input');
                input.type = 'text';
                input.name = i;
                input.value = params[i];
                form.appendChild(input);
            }
        }
        document.body.appendChild(form);
        var iframe = document.createElement("iframe");
		iframe.setAttribute('id', 'teste2');
		iframe.setAttribute('name', 'teste2');
		iframe.style.width = "100%";
		iframe.style.height = "100%";
		var mario = divId.appendChild(iframe);
		console.log(mario);
		console.log(iframe);
        form.submit();
        document.body.removeChild(form);
	}
	function mario () {
		const iframe = document.getElementById('teste2');
		iframe.contentWindow.postMessage('teste', '*');
	}
</script>
</body>
</html>Ã 